# 宝塔部署说明

## 项目文件结构
```
mov/
├── server.js              # 主服务器文件
├── package.json           # 项目依赖配置
├── ecosystem.config.js    # PM2进程管理配置
├── nginx-simple.conf      # Nginx配置文件
├── public/                # 静态资源目录
│   ├── css/style.css     # 样式文件
│   ├── js/app.js         # JavaScript文件
│   └── images/           # 图片资源
├── views/                 # 模板文件
│   ├── index.ejs         # 主页模板
│   └── test.ejs          # 测试页面模板
└── 宝塔部署指南.md        # 详细部署指南
```

## 快速部署步骤

### 1. 上传文件
将整个 `mov` 目录上传到服务器的 `/opt/mov`

### 2. 服务器端命令
```bash
# 进入项目目录
cd /opt/mov

# 停止现有服务
pm2 stop movie-streaming-platform || true
pm2 delete movie-streaming-platform || true

# 安装依赖
npm install --production

# 设置权限
chown -R www:www /opt/mov
chmod -R 755 /opt/mov

# 启动服务
pm2 start ecosystem.config.js --env production

# 设置开机自启
pm2 startup
pm2 save

# 检查状态
pm2 status
```

### 3. 配置Nginx
将 `nginx-simple.conf` 的内容复制到宝塔面板的网站配置中

### 4. 访问地址
- 主页：http://1.116.113.209:3000
- 测试页：http://1.116.113.209:3000/test

## 常用命令
```bash
pm2 status                    # 查看状态
pm2 logs movie-streaming-platform  # 查看日志
pm2 restart movie-streaming-platform  # 重启服务
pm2 stop movie-streaming-platform     # 停止服务
```

## 故障排除
1. **端口冲突**：`lsof -ti:3000 | xargs kill -9`
2. **权限问题**：`chown -R www:www /opt/mov`
3. **查看日志**：`pm2 logs movie-streaming-platform`
