# ğŸ¬ ç”µå½±å¹³å° Docker éƒ¨ç½²æŒ‡å—

è¿™æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„åœ¨çº¿ç”µå½±è§‚çœ‹å¹³å°ï¼Œæ”¯æŒ Docker å®¹å™¨åŒ–éƒ¨ç½²ã€‚

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Docker**: 20.10+ 
- **Docker Compose**: 2.0+
- **å†…å­˜**: è‡³å°‘ 1GB å¯ç”¨å†…å­˜
- **ç£ç›˜**: è‡³å°‘ 2GB å¯ç”¨ç©ºé—´

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <your-repo-url>
cd mov
```

### 2. ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
./deploy.sh dev

# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
./deploy.sh prod

# æŸ¥çœ‹å¸®åŠ©
./deploy.sh help
```

### 3. æ‰‹åŠ¨éƒ¨ç½²

#### å¼€å‘ç¯å¢ƒ
```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### ç”Ÿäº§ç¯å¢ƒ
```bash
# æ„å»ºå¹¶å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.prod.yml up -d

# æŸ¥çœ‹çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps
```

## ğŸ”§ éƒ¨ç½²è„šæœ¬å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `./deploy.sh dev` | å¯åŠ¨å¼€å‘ç¯å¢ƒ (ç«¯å£ 3000) |
| `./deploy.sh prod` | å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ (ç«¯å£ 80) |
| `./deploy.sh stop` | åœæ­¢æ‰€æœ‰æœåŠ¡ |
| `./deploy.sh logs` | æŸ¥çœ‹åº”ç”¨æ—¥å¿— |
| `./deploy.sh status` | æŸ¥çœ‹æœåŠ¡çŠ¶æ€ |
| `./deploy.sh cleanup` | æ¸…ç† Docker èµ„æº |
| `./deploy.sh help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |

## ğŸŒ è®¿é—®åœ°å€

- **å¼€å‘ç¯å¢ƒ**: http://localhost:3000
- **ç”Ÿäº§ç¯å¢ƒ**: http://localhost:80

## ğŸ“ é¡¹ç›®ç»“æ„

```
mov/
â”œâ”€â”€ Dockerfile                 # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml         # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ docker-compose.prod.yml    # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ .dockerignore              # Docker å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ deploy.sh                  # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ server.js                  # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”œâ”€â”€ package.json               # Node.js ä¾èµ–
â”œâ”€â”€ public/                    # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ images/
â”œâ”€â”€ views/                     # æ¨¡æ¿æ–‡ä»¶
â””â”€â”€ logs/                      # æ—¥å¿—ç›®å½•
```

## ğŸ” ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹å®¹å™¨çŠ¶æ€
```bash
docker-compose ps
```

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
docker-compose logs -f movie-app
```

### æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
```bash
docker stats movie-streaming-platform
```

### è¿›å…¥å®¹å™¨è°ƒè¯•
```bash
docker-compose exec movie-app sh
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### 1. ç«¯å£å†²çª
å¦‚æœç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„ï¼š
```yaml
ports:
  - "8080:3000"  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

### 2. å†…å­˜ä¸è¶³
å¦‚æœé‡åˆ°å†…å­˜é—®é¢˜ï¼Œå¯ä»¥è°ƒæ•´èµ„æºé™åˆ¶ï¼š
```yaml
deploy:
  resources:
    limits:
      memory: 1G
    reservations:
      memory: 512M
```

### 3. å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
docker-compose logs movie-app

# é‡æ–°æ„å»ºé•œåƒ
docker-compose build --no-cache
```

### 4. æ¸…ç†èµ„æº
```bash
# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker-compose down

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨
docker system prune -f

# å®Œå…¨æ¸…ç†ï¼ˆåŒ…æ‹¬å·ï¼‰
docker-compose down --volumes --remove-orphans
```

## ğŸ”’ å®‰å…¨é…ç½®

### 1. ç”Ÿäº§ç¯å¢ƒå®‰å…¨
- ä½¿ç”¨é root ç”¨æˆ·è¿è¡Œå®¹å™¨
- å¯ç”¨å¥åº·æ£€æŸ¥
- é™åˆ¶èµ„æºä½¿ç”¨
- é…ç½®æ—¥å¿—è½®è½¬

### 2. HTTPS é…ç½®ï¼ˆå¯é€‰ï¼‰
å¦‚æœéœ€è¦ HTTPSï¼Œå¯ä»¥é…ç½® Nginx åå‘ä»£ç†ï¼š

```bash
# å°† SSL è¯ä¹¦æ”¾åœ¨ ssl/ ç›®å½•
mkdir ssl
# å¤åˆ¶ä½ çš„è¯ä¹¦æ–‡ä»¶åˆ° ssl/ ç›®å½•
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. é•œåƒä¼˜åŒ–
- ä½¿ç”¨ Alpine Linux åŸºç¡€é•œåƒ
- å¤šé˜¶æ®µæ„å»ºå‡å°‘é•œåƒå¤§å°
- æ¸…ç† npm ç¼“å­˜

### 2. å®¹å™¨ä¼˜åŒ–
- è®¾ç½®èµ„æºé™åˆ¶
- å¯ç”¨å¥åº·æ£€æŸ¥
- é…ç½®é‡å¯ç­–ç•¥

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### æ›´æ–°åº”ç”¨
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡æ–°æ„å»ºå¹¶éƒ¨ç½²
./deploy.sh prod
```

### å›æ»šç‰ˆæœ¬
```bash
# åˆ‡æ¢åˆ°ä¹‹å‰çš„ç‰ˆæœ¬
git checkout <previous-commit>

# é‡æ–°éƒ¨ç½²
./deploy.sh prod
```

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Docker å’Œ Docker Compose ç‰ˆæœ¬
2. ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
3. ç½‘ç»œè¿æ¥çŠ¶æ€
4. å®¹å™¨æ—¥å¿—ä¿¡æ¯

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼Œè¯·æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´é…ç½®ã€‚
